/* M Share â€“ Voice Assistant visibility fix (scoped) */
#mshare-voicebot{color-scheme:light dark}
html[data-theme="dark"] #mshare-voicebot{
  --ms-voice-bg:#111827; --ms-voice-fg:#f9fafb; --ms-voice-border:#374151; --ms-voice-accent:#60a5fa;
}
html[data-theme="light"] #mshare-voicebot,
html:not([data-theme]) #mshare-voicebot{
  --ms-voice-bg:#ffffff; --ms-voice-fg:#111827; --ms-voice-border:#e5e7eb; --ms-voice-accent:#2563eb;
}

/* FORCE button text to be visible regardless of site-wide effects */
#mshare-voicebot .mshare-voicebot__btn{
  color: var(--ms-voice-fg) !important;
  -webkit-text-fill-color: currentColor !important;
  -webkit-background-clip: border-box !important;
  background-clip: border-box !important;
  text-shadow: none !important;
  filter: none !important;
  opacity: 1 !important;
  font-size: 14px !important;
  font-weight: 600 !important;
  letter-spacing: .2px !important;
  line-height: 1 !important;
}

/* Start button: white text on accent background */
#mshare-voicebot .mshare-voicebot__btn[data-voice-action="start"]{
  color:#fff !important;
  -webkit-text-fill-color:#fff !important;
  background: var(--ms-voice-accent) !important;
  border-color: transparent !important;
}

/* Ensure inputs/selects also remain readable */
#mshare-voicebot .mshare-voicebot__select,
#mshare-voicebot .mshare-voicebot__cmd,
#mshare-voicebot .mshare-voicebot__range{
  color: var(--ms-voice-fg) !important;
  -webkit-text-fill-color: currentColor !important;
  background: var(--ms-voice-bg) !important;
  border-color: var(--ms-voice-border) !important;
}

/* High-contrast / Windows forced colors */
@media (forced-colors: active){
  #mshare-voicebot .mshare-voicebot__btn{
    color: ButtonText !important;
    background: ButtonFace !important;
    border-color: ButtonBorder !important;
  }
  #mshare-voicebot .mshare-voicebot__btn[data-voice-action="start"]{
    background: Highlight !important;
    color: HighlightText !important;
  }
}
