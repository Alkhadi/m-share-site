(() => { if (window.__NAV_CORE__) return; window.__NAV_CORE__ = true; function r(f) { if (document.readyState === 'loading') { document.addEventListener('DOMContentLoaded', f, { once: true }); } else { f(); } } r(() => { const nav = document.getElementById('mainNav'); if (!nav) return; let t = document.getElementById('navToggle'); if (!t) { t = document.createElement('button'); t.id = 'navToggle'; t.className = 'nav-toggle'; t.setAttribute('aria-label', 'Menu'); t.setAttribute('aria-expanded', 'false'); t.setAttribute('aria-controls', 'mainNav'); t.textContent = 'â˜°'; (document.querySelector('.navbar') || nav.parentElement || document.body).appendChild(t); } const open = () => { nav.classList.add('open'); t.setAttribute('aria-expanded', 'true'); }, close = () => { nav.classList.remove('open'); t.setAttribute('aria-expanded', 'false'); };['click', 'touchstart'].forEach(ev => t.addEventListener(ev, e => { e.preventDefault(); nav.classList.contains('open') ? close() : open(); }, { passive: false })); const groups = [...nav.querySelectorAll('.menu-group')]; groups.forEach(g => { const b = g.querySelector('.menu-toggle'); if (!b) return;['click', 'touchstart'].forEach(ev => b.addEventListener(ev, e => { e.preventDefault(); e.stopPropagation(); const willOpen = !g.classList.contains('open'); if (window.innerWidth > 760 && willOpen) { groups.forEach(o => { if (o !== g) { o.classList.remove('open'); const ob = o.querySelector('.menu-toggle'); ob && ob.setAttribute('aria-expanded', 'false'); } }); } g.classList.toggle('open'); b.setAttribute('aria-expanded', g.classList.contains('open') ? 'true' : 'false'); }, { passive: false })); }); document.addEventListener('click', e => { if (!nav.contains(e.target)) { groups.forEach(o => { o.classList.remove('open'); const ob = o.querySelector('.menu-toggle'); ob && ob.setAttribute('aria-expanded', 'false'); }); } }); nav.addEventListener('click', e => { const a = e.target.closest('a[data-href],a[href]'); if (!a) return; const href = a.getAttribute('data-href') || a.getAttribute('href'); if (!href || href === '#') return; if (window.innerWidth <= 760) close(); }); window.addEventListener('resize', () => { if (window.innerWidth > 760) close(); }, { passive: true }); }); })();
